
The following have been reloaded with a version change:
  1) cuda/12.6.0 => cuda/12.1.1


CondaError: Run 'conda init' before 'conda activate'

wandb: Currently logged in as: wang4538 (rajdeeph-purdue-university). Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.4
wandb: Run data is saved locally in /home/wang4538/DGMS-master/scripts/wandb/run-20250415_223627-eply6pr7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run meta-llama/Llama-3.2-1B_K16_KL_SPAS0.75_temp0.001_LR5e-5_PRTEMP0.01_WD5e-7_SIGMA3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/rajdeeph-purdue-university/SQS_GLUE
wandb: üöÄ View run at https://wandb.ai/rajdeeph-purdue-university/SQS_GLUE/runs/eply6pr7
[running kmeans]: 0it [00:00, ?it/s][running kmeans]: 0it [00:00, ?it/s, center_shift=0.002305, iteration=1, tol=0.000100][running kmeans]: 1it [00:00,  1.75it/s, center_shift=0.002305, iteration=1, tol=0.000100][running kmeans]: 1it [00:01,  1.75it/s, center_shift=0.001139, iteration=2, tol=0.000100][running kmeans]: 2it [00:01,  1.98it/s, center_shift=0.001139, iteration=2, tol=0.000100][running kmeans]: 2it [00:01,  1.98it/s, center_shift=0.000740, iteration=3, tol=0.000100][running kmeans]: 3it [00:01,  2.09it/s, center_shift=0.000740, iteration=3, tol=0.000100][running kmeans]: 3it [00:01,  2.09it/s, center_shift=0.000553, iteration=4, tol=0.000100][running kmeans]: 4it [00:01,  2.15it/s, center_shift=0.000553, iteration=4, tol=0.000100][running kmeans]: 4it [00:02,  2.15it/s, center_shift=0.000455, iteration=5, tol=0.000100][running kmeans]: 5it [00:02,  2.19it/s, center_shift=0.000455, iteration=5, tol=0.000100][running kmeans]: 5it [00:02,  2.19it/s, center_shift=0.000390, iteration=6, tol=0.000100][running kmeans]: 6it [00:02,  2.21it/s, center_shift=0.000390, iteration=6, tol=0.000100][running kmeans]: 6it [00:03,  2.21it/s, center_shift=0.000345, iteration=7, tol=0.000100][running kmeans]: 7it [00:03,  2.22it/s, center_shift=0.000345, iteration=7, tol=0.000100][running kmeans]: 7it [00:03,  2.22it/s, center_shift=0.000305, iteration=8, tol=0.000100][running kmeans]: 8it [00:03,  2.22it/s, center_shift=0.000305, iteration=8, tol=0.000100][running kmeans]: 8it [00:04,  2.22it/s, center_shift=0.000276, iteration=9, tol=0.000100][running kmeans]: 9it [00:04,  2.23it/s, center_shift=0.000276, iteration=9, tol=0.000100][running kmeans]: 9it [00:04,  2.23it/s, center_shift=0.000251, iteration=10, tol=0.000100][running kmeans]: 10it [00:04,  2.23it/s, center_shift=0.000251, iteration=10, tol=0.000100][running kmeans]: 10it [00:05,  2.23it/s, center_shift=0.000232, iteration=11, tol=0.000100][running kmeans]: 11it [00:05,  2.23it/s, center_shift=0.000232, iteration=11, tol=0.000100][running kmeans]: 11it [00:05,  2.23it/s, center_shift=0.000214, iteration=12, tol=0.000100][running kmeans]: 12it [00:05,  2.24it/s, center_shift=0.000214, iteration=12, tol=0.000100][running kmeans]: 12it [00:05,  2.24it/s, center_shift=0.000198, iteration=13, tol=0.000100][running kmeans]: 13it [00:05,  2.24it/s, center_shift=0.000198, iteration=13, tol=0.000100][running kmeans]: 13it [00:06,  2.24it/s, center_shift=0.000181, iteration=14, tol=0.000100][running kmeans]: 14it [00:06,  2.24it/s, center_shift=0.000181, iteration=14, tol=0.000100][running kmeans]: 14it [00:06,  2.24it/s, center_shift=0.000168, iteration=15, tol=0.000100][running kmeans]: 15it [00:06,  2.24it/s, center_shift=0.000168, iteration=15, tol=0.000100][running kmeans]: 15it [00:07,  2.24it/s, center_shift=0.000159, iteration=16, tol=0.000100][running kmeans]: 16it [00:07,  2.24it/s, center_shift=0.000159, iteration=16, tol=0.000100][running kmeans]: 16it [00:07,  2.24it/s, center_shift=0.000149, iteration=17, tol=0.000100][running kmeans]: 17it [00:07,  2.24it/s, center_shift=0.000149, iteration=17, tol=0.000100][running kmeans]: 17it [00:08,  2.24it/s, center_shift=0.000142, iteration=18, tol=0.000100][running kmeans]: 18it [00:08,  2.24it/s, center_shift=0.000142, iteration=18, tol=0.000100][running kmeans]: 18it [00:08,  2.24it/s, center_shift=0.000137, iteration=19, tol=0.000100][running kmeans]: 19it [00:08,  2.24it/s, center_shift=0.000137, iteration=19, tol=0.000100][running kmeans]: 19it [00:09,  2.24it/s, center_shift=0.000132, iteration=20, tol=0.000100][running kmeans]: 20it [00:09,  2.23it/s, center_shift=0.000132, iteration=20, tol=0.000100][running kmeans]: 20it [00:09,  2.23it/s, center_shift=0.000126, iteration=21, tol=0.000100][running kmeans]: 21it [00:09,  2.23it/s, center_shift=0.000126, iteration=21, tol=0.000100][running kmeans]: 21it [00:09,  2.23it/s, center_shift=0.000120, iteration=22, tol=0.000100][running kmeans]: 22it [00:09,  2.23it/s, center_shift=0.000120, iteration=22, tol=0.000100][running kmeans]: 22it [00:10,  2.23it/s, center_shift=0.000110, iteration=23, tol=0.000100][running kmeans]: 23it [00:10,  2.23it/s, center_shift=0.000110, iteration=23, tol=0.000100][running kmeans]: 23it [00:10,  2.23it/s, center_shift=0.000114, iteration=24, tol=0.000100][running kmeans]: 24it [00:10,  2.23it/s, center_shift=0.000114, iteration=24, tol=0.000100][running kmeans]: 24it [00:11,  2.23it/s, center_shift=0.000107, iteration=25, tol=0.000100][running kmeans]: 25it [00:11,  2.24it/s, center_shift=0.000107, iteration=25, tol=0.000100][running kmeans]: 25it [00:11,  2.24it/s, center_shift=0.000099, iteration=26, tol=0.000100][running kmeans]: 26it [00:11,  2.24it/s, center_shift=0.000099, iteration=26, tol=0.000100][running kmeans]: 26it [00:11,  2.21it/s, center_shift=0.000099, iteration=26, tol=0.000100]
Traceback (most recent call last):
  File "/home/wang4538/DGMS-master/scripts/../glue_training.py", line 599, in <module>
    main(args)
  File "/home/wang4538/DGMS-master/scripts/../glue_training.py", line 303, in main
    InitModel(model, args.sigma)
  File "/home/wang4538/DGMS-master/scripts/../glue_training.py", line 139, in InitModel
    m.init_mask_params(sigma)
  File "/home/wang4538/DGMS-master/QuantAttention.py", line 764, in init_mask_params
    self.q_proj.sub_distribution = gmm_approximation(self.k_level, self.q_proj.weight, self.temperature, 32, init_method, sigma)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wang4538/DGMS-master/modeling/DGMS/GMM.py", line 250, in gmm_approximation
    return GaussianMixtureModel(num_components, init_weights, temperature, B, init_method, sigma)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wang4538/DGMS-master/modeling/DGMS/GMM.py", line 43, in __init__
    self.params_initialization(init_weights, init_method)
  File "/home/wang4538/DGMS-master/modeling/DGMS/GMM.py", line 71, in params_initialization
    initial_region_saliency, pi_init, pi_zero_init, sigma_init, _sigma_zero = cluster_weights(init_weights, self.num_components)
                                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wang4538/miniconda3/envs/LLM/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/wang4538/DGMS-master/utils/misc.py", line 121, in cluster_weights
    sigma_tmp[i] = torch.sum((flat_weight[_idxs]-region_saliency_tmp[i])**2)
                              ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
